# WinUI 3 WinRT 命名空间基础

Windows app sdk API 较多比较混乱，本文旨在理清相关的 WinRT 命名空间的基础知识，帮助开发者更好地理解 WinUI 3 的 API。

## 继承关系

### 基本继承链

> IUnknown (Win32 COM ABI defined in `unknwn.h`) / Windows.Foundation.IUnkown (WinRT Interface wrapper for Win32) -> IInspectable (Win32 COM ABI defined in `inspectable.h`) / Windows.Foundation.IInspectable (WinRT Interface wrapper for Win32) -> Microsoft.UI.Xaml.DependencyObject -> Microsoft.UI.Xaml.UIElement -> Microsoft.UI.Xaml.FrameworkElement -> ( ... )

### 描述

`DependencyObject` 类在其许多派生类上启用依赖属性系统服务，并且是许多重要 UI 相关类（如 [UIElement](https://learn.microsoft.com/en-us/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.uielement?view=windows-app-sdk-1.6)、 [Geometry](https://learn.microsoft.com/en-us/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.geometry?view=windows-app-sdk-1.6)、 [FrameworkTemplate](https://learn.microsoft.com/en-us/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.frameworktemplate?view=windows-app-sdk-1.6)、 [Style](https://learn.microsoft.com/en-us/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.style?view=windows-app-sdk-1.6) 和 [ResourceDictionary](https://learn.microsoft.com/en-us/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.resourcedictionary?view=windows-app-sdk-1.6)）的直接基类。对象通过声明实现此类来参与依赖属性系统，这将允许对象在运行时注册依赖属性到依赖属性系统。

依赖属性系统的主要功能是计算属性值，并提供有关已更改的值的系统通知。参与依赖属性系统的另一个关键类是 `DependencyProperty`。`DependencyProperty` 允许将依赖属性注册到属性系统中，而 DependencyObject 作为基类，实现了 `DependencyObject` 基类的对象可以使用和设置依赖属性。

`DependencyObject` 是多个派生类的直接父类，这些类是应用程序和 XAML UI 编程模型的基础。下面是一些值得注意的派生类：

- [UIElement (UI元素)](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.uielement?view=windows-app-sdk-1.6)：这是大多数可以处理 UI 输入的视觉对象的基类。[FrameworkElement](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.frameworkelement?view=windows-app-sdk-1.6) 在这个层次结构中进一步（`FrameworkElement` 的直接基类是 `UIElement`）， [Control](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.control?view=windows-app-sdk-1.6) 也是如此 （`Control` 的直接基类是 `FrameworkElement`）。因此在 Windows 运行时中，有数百个控件和其他类的类层次结构中都具有 [UIElement](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.uielement?view=windows-app-sdk-1.6) 类。
- XAML 样式系统支持类： [FrameworkTemplate](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.frameworktemplate?view=windows-app-sdk-1.6) ([ControlTemplate](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.controltemplate?view=windows-app-sdk-1.6)、 [DataTemplate](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.datatemplate?view=windows-app-sdk-1.6)、 [ItemsPanelTemplate](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.itemspaneltemplate?view=windows-app-sdk-1.6)) 、 [Style](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.style?view=windows-app-sdk-1.6)、 [SetterBase](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.setterbase?view=windows-app-sdk-1.6) ([Setter](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.setter?view=windows-app-sdk-1.6)) 、 [ToolTipTemplateSettings](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.primitives.tooltiptemplatesettings?view=windows-app-sdk-1.6) 和其他 **TemplateSettings** 的父级。
- 视觉状态模型： [Transition](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.animation.transition?view=windows-app-sdk-1.6)、 [VisualState](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.visualstate?view=windows-app-sdk-1.6)、 [VisualStateGroup](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.visualstategroup?view=windows-app-sdk-1.6)、 [VisualStateManager](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.visualstatemanager?view=windows-app-sdk-1.6)、 [VisualTransition](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.visualtransition?view=windows-app-sdk-1.6)。
- 数据绑定支持： [BindingBase](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.data.bindingbase?view=windows-app-sdk-1.6) ([Binding](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.data.binding?view=windows-app-sdk-1.6)) 、 [CollectionViewSource](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.data.collectionviewsource?view=windows-app-sdk-1.6)、 [PropertyPath](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.propertypath?view=windows-app-sdk-1.6)、 [RelativeSource](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.data.relativesource?view=windows-app-sdk-1.6) 的父级。
- 故事板动画： [TimeLine](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.animation.timeline?view=windows-app-sdk-1.6) ([Storyboard](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.animation.storyboard?view=windows-app-sdk-1.6) 的父级、类型化动画、主题动画) 、输入关键帧 (如 [ColorKeyFrame](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.animation.colorkeyframe?view=windows-app-sdk-1.6) 、 [KeySpline](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.animation.keyspline?view=windows-app-sdk-1.6)、 [EasingFunctionBase](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.animation.easingfunctionbase?view=windows-app-sdk-1.6)）。
- XAML 图形和呈现基元： [Brush](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.brush?view=windows-app-sdk-1.6)、 [Geometry](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.geometry?view=windows-app-sdk-1.6)、 [GeneralTransform](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.generaltransform?view=windows-app-sdk-1.6)、 [GradientStop](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.gradientstop?view=windows-app-sdk-1.6)、 [PathFigure](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.pathfigure?view=windows-app-sdk-1.6)、 [PathSegment](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.pathsegment?view=windows-app-sdk-1.6)、 [Projection](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.projection?view=windows-app-sdk-1.6)。
- 图像处理和呈现表面互操作： [ImageSource](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.imagesource?view=windows-app-sdk-1.6) ([BitmapSource](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.imaging.bitmapsource?view=windows-app-sdk-1.6)、 [RenderTargetBitmap](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.imaging.rendertargetbitmap?view=windows-app-sdk-1.6)、 [SurfaceImageSource](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.media.imaging.surfaceimagesource?view=windows-app-sdk-1.6) 和其他) 的父级。
- [Window](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.window?view=windows-app-sdk-1.6)：表示应用顶级界面的窗口，可以承载页面等元素，页面也必须由 Window 承载。
- [FlyoutBase](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.primitives.flyoutbase?view=windows-app-sdk-1.6) ([Flyout](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.flyout?view=windows-app-sdk-1.6) 和 [MenuFlyout](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.menuflyout?view=windows-app-sdk-1.6)) 的父级。
- [ResourceDictionary](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.resourcedictionary?view=windows-app-sdk-1.6)：在 XAML 中定义资源字典。
- [TextElement](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.documents.textelement?view=windows-app-sdk-1.6)： [Block](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.documents.block?view=windows-app-sdk-1.6) 和 [Inline](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.documents.inline?view=windows-app-sdk-1.6) 的父级，这些元素又是用于 [TextBlock](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.textblock?view=windows-app-sdk-1.6) 内容或富文本元素的文本元素的基类。
- [AutomationPeer](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.automation.peers.automationpeer?view=windows-app-sdk-1.6)：代表 XAML 控件提供支持给 Microsoft UI Automation 监听器的 Microsoft UI Automation 系列类的基类。同时也是 [IRawElementProviderSimple](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.automation.provider.irawelementprovidersimple?view=windows-app-sdk-1.6) 的基类。
- 杂项： [CacheMode](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.uielement.cachemode?view=windows-app-sdk-1.6#microsoft-ui-xaml-uielement-cachemode)、 [ColumnDefinition](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.columndefinition?view=windows-app-sdk-1.6)、 [DependencyObjectCollection](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.dependencyobjectcollection?view=windows-app-sdk-1.6)、 [InputScope](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.input.inputscope?view=windows-app-sdk-1.6)、 [InputScopeName](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.input.inputscopename?view=windows-app-sdk-1.6)、 [PageStackEntry](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.navigation.pagestackentry?view=windows-app-sdk-1.6)、 [PrintDocument](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.printing.printdocument?view=windows-app-sdk-1.6)、 [RowDefinition](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.rowdefinition?view=windows-app-sdk-1.6)、 [TriggerAction](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.triggeraction?view=windows-app-sdk-1.6)、 [TriggerBase](https://learn.microsoft.com/zh-cn/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.triggerbase?view=windows-app-sdk-1.6)。
