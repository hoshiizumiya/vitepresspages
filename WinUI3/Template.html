<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C++/WinRT åŸç†åŠå®è·µ â€”â€” æ¨¡æ¿å…ƒç¼–ç¨‹åœ¨ WinRT ä¸­çš„å®ç° | Hoshiizumiya</title>
    <meta name="description" content="learn notes">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/vitepresspages/assets/style.CN1xNsPh.css" as="style">
    <link rel="preload stylesheet" href="/vitepresspages/vp-icons.css" as="style">
    
    <script type="module" src="/vitepresspages/assets/app.CVRw5pHX.js"></script>
    <link rel="preload" href="/vitepresspages/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/vitepresspages/assets/chunks/theme.CsjXfZ_X.js">
    <link rel="modulepreload" href="/vitepresspages/assets/chunks/framework.eveauE4a.js">
    <link rel="modulepreload" href="/vitepresspages/assets/WinUI3_Template.md.r3NsfvdX.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/vitepresspages/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>Hoshiizumiya</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/vitepresspages/index.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/vitepresspages/README.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>About me</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/hoshiizumiya" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/hoshiizumiya" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>è¿‡æ—¶çš„é¡¹ç›®æŒ‡å—</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/gitbook%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%E5%85%A8%E6%8C%87%E5%8D%97/gitbook%E9%83%A8%E7%BD%B2%E7%AE%80%E4%BB%8B.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>gitbookæœ¬åœ°éƒ¨ç½²</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>C++</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/C++/%E7%9B%AE%E5%BD%95.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>ç›®å½•</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/C++/%E5%AD%97%E7%AC%A6%E4%B8%B2.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>å­—ç¬¦ä¸²</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/C++/%E6%8C%87%E9%92%88.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>æŒ‡é’ˆ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/C++/%E8%BF%9E%E7%BB%AD%E8%AF%BB%E5%8F%96.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>è¿ç»­è¯»å–</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/C++/2.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>JAVAç±»æ•°ç»„å’Œæ–¹æ³•çš„é‡æ„</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/C++/memory1.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>C++ 11 â€”â€” ç§»åŠ¨è¯­ä¹‰</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>è®¡ç®—æœºå›¾å½¢å­¦</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/%E7%9B%AE%E5%BD%95.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>ç›®å½•</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>WinUI3 C++/WinRT åŸç†åŠå®è·µ</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/index.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>ç›®å½•</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/EP3.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>EP3</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/TitleBar.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>cpp/WinRTå…¥é—¨-TitleBaræ ‡é¢˜æ </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/Template.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>cpp/WinRTå…¥é—¨-æ¨¡æ¿å…ƒç¼–ç¨‹åœ¨ WinRT ä¸­çš„å®ç°</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/Loaded.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>cpp/WinRTå…¥é—¨-Loadedäº‹ä»¶</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/Page&amp;Window1.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>cpp/WinRTå…¥é—¨-é¡µé¢æ“ä½œå…¶ä¸€</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/Page&amp;Window2.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>cpp/WinRTå…¥é—¨-é¡µé¢æ“ä½œå…¶äºŒ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/InitializeComponent.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>cpp/WinRTå…¥é—¨-é¡µé¢åˆå§‹åŒ–</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/data&amp;ui.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>cpp/WinRTå…¥é—¨-æ•°æ®ä¸ç•Œé¢ç»‘å®šæ›´æ–°</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/winui3-advanced-binding.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>cpp/WinRTå…¥é—¨-é«˜çº§æ•°æ®ç»‘å®šä¸ MVVM æ¶æ„å®è·µP1</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/interface.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>cpp/WinRTå…¥é—¨-WinRT æ¥å£æœºåˆ¶ä¸ç»§æ‰¿æ¨¡å‹è¯¦è§£</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/WinUI3-WinRT-CPP-%E5%AE%8C%E6%95%B4%E6%95%99%E7%A8%8B-%E7%AC%AC%E9%9B%B6%E9%83%A8%E5%88%86-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E4%B8%8E%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>ç³»åˆ—æ•™ç¨‹-ç¬¬é›¶éƒ¨åˆ†-ç¯å¢ƒé…ç½®ä¸åŸºç¡€æ¦‚å¿µ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/WinUI3-WinRT-CPP-%E5%AE%8C%E6%95%B4%E6%95%99%E7%A8%8B-%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86-%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5%E4%B8%8E%E6%9E%B6%E6%9E%84.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>ç³»åˆ—æ•™ç¨‹-ç¬¬ä¸€éƒ¨åˆ†-åŸºç¡€æ¦‚å¿µä¸æ¶æ„</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/WinUI3-WinRT-CPP-%E5%AE%8C%E6%95%B4%E6%95%99%E7%A8%8B-%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86-%E5%AE%9E%E8%B7%B5%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>ç³»åˆ—æ•™ç¨‹-ç¬¬äºŒéƒ¨åˆ†-å®è·µå¼€å‘æŒ‡å—</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/WinUI3-WinRT-CPP-%E5%AE%8C%E6%95%B4%E6%95%99%E7%A8%8B-%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86-%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7%E4%B8%8E%E6%B7%B1%E5%BA%A6%E5%BC%80%E5%8F%91.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>ç³»åˆ—æ•™ç¨‹-ç¬¬ä¸‰éƒ¨åˆ†-é«˜çº§ç‰¹æ€§ä¸æ·±åº¦å¼€å‘</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/WinUI3-WinRT-CPP-%E5%AE%8C%E6%95%B4%E6%95%99%E7%A8%8B-%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86-%E5%9F%BA%E7%A1%80API%E4%B8%8E%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>ç³»åˆ—æ•™ç¨‹-ç¬¬å››éƒ¨åˆ†-åŸºç¡€APIä¸ç±»å‹ç³»ç»Ÿæ·±åº¦è§£æ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/WinUI3-WinRT-CPP-%E5%AE%8C%E6%95%B4%E6%95%99%E7%A8%8B-%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86-XAML%E6%A1%86%E6%9E%B6%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E6%B7%B1%E5%B1%82%E6%9C%BA%E5%88%B6.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>ç³»åˆ—æ•™ç¨‹-ç¬¬äº”éƒ¨åˆ†-XAMLæ¡†æ¶ä¸æ•°æ®ç»‘å®šæ·±å±‚æœºåˆ¶</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/WinUI3-WinRT-CPP-%E5%AE%8C%E6%95%B4%E6%95%99%E7%A8%8B-%E7%AC%AC%E5%85%AD%E9%83%A8%E5%88%86-%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>ç³»åˆ—æ•™ç¨‹-ç¬¬å…­éƒ¨åˆ†-å®æˆ˜æŠ€å·§ä¸æœ€ä½³å®è·µ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepresspages/WinUI3/scale.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Windows ç¼©æ”¾æ§åˆ¶</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _vitepresspages_WinUI3_Template" data-v-39a288b8><div><h1 id="c-winrt-åŸç†åŠå®è·µ-â€”â€”-æ¨¡æ¿å…ƒç¼–ç¨‹åœ¨-winrt-ä¸­çš„å®ç°" tabindex="-1">C++/WinRT åŸç†åŠå®è·µ â€”â€” æ¨¡æ¿å…ƒç¼–ç¨‹åœ¨ WinRT ä¸­çš„å®ç° <a class="header-anchor" href="#c-winrt-åŸç†åŠå®è·µ-â€”â€”-æ¨¡æ¿å…ƒç¼–ç¨‹åœ¨-winrt-ä¸­çš„å®ç°" aria-label="Permalink to &quot;C++/WinRT åŸç†åŠå®è·µ â€”â€” æ¨¡æ¿å…ƒç¼–ç¨‹åœ¨ WinRT ä¸­çš„å®ç°&quot;">â€‹</a></h1><h2 id="ğŸ“š-å‰ç½®çŸ¥è¯†-ä»é›¶å¼€å§‹ç†è§£å…³é”®æ¦‚å¿µ" tabindex="-1">ğŸ“š å‰ç½®çŸ¥è¯†ï¼šä»é›¶å¼€å§‹ç†è§£å…³é”®æ¦‚å¿µ <a class="header-anchor" href="#ğŸ“š-å‰ç½®çŸ¥è¯†-ä»é›¶å¼€å§‹ç†è§£å…³é”®æ¦‚å¿µ" aria-label="Permalink to &quot;ğŸ“š å‰ç½®çŸ¥è¯†ï¼šä»é›¶å¼€å§‹ç†è§£å…³é”®æ¦‚å¿µ&quot;">â€‹</a></h2><p>åœ¨æ·±å…¥åˆ†æä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£ä¸€äº›å…³é”®çš„åŸºç¡€æ¦‚å¿µï¼Œè¿™äº›æ¦‚å¿µå¯¹äºç†è§£ C++/WinRT çš„å·¥ä½œåŸç†è‡³å…³é‡è¦ã€‚</p><h3 id="ğŸ”-ä»€ä¹ˆæ˜¯-com-ä¸ºä»€ä¹ˆéœ€è¦å®ƒ" tabindex="-1">ğŸ” ä»€ä¹ˆæ˜¯ COMï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ <a class="header-anchor" href="#ğŸ”-ä»€ä¹ˆæ˜¯-com-ä¸ºä»€ä¹ˆéœ€è¦å®ƒ" aria-label="Permalink to &quot;ğŸ” ä»€ä¹ˆæ˜¯ COMï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ&quot;">â€‹</a></h3><p><strong>COM (Component Object Model)</strong> æ˜¯å¾®è½¯å¼€å‘çš„ç»„ä»¶å¯¹è±¡æ¨¡å‹ï¼Œæ˜¯ç†è§£ WinRT çš„åŸºç¡€ï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// COM çš„æ ¸å¿ƒæ¦‚å¿µï¼šæ¥å£</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IUnknown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    virtual</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HRESULT</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> QueryInterface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">REFIID</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> riid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void**</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> ppvObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    virtual</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ULONG</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AddRef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    virtual</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ULONG</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Release</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p><strong>ä¸ºä»€ä¹ˆéœ€è¦ COMï¼Ÿ</strong></p><ul><li><strong>è·¨è¯­è¨€äº’æ“ä½œ</strong>ï¼šè®© C++ã€C#ã€VB.NET ç­‰ä¸åŒè¯­è¨€å¯ä»¥äº’ç›¸è°ƒç”¨</li><li><strong>äºŒè¿›åˆ¶å…¼å®¹æ€§</strong>ï¼šä¸åŒç¼–è¯‘å™¨äº§ç”Ÿçš„ä»£ç å¯ä»¥äº’ç›¸è°ƒç”¨</li><li><strong>ç‰ˆæœ¬å…¼å®¹</strong>ï¼šæ–°ç‰ˆæœ¬çš„ç»„ä»¶å¯ä»¥ä¸æ—§ç‰ˆæœ¬çš„å®¢æˆ·ç«¯å…¼å®¹</li><li><strong>è¿›ç¨‹éš”ç¦»</strong>ï¼šç»„ä»¶å¯ä»¥è¿è¡Œåœ¨ä¸åŒçš„è¿›ç¨‹ä¸­</li></ul><p><strong>å®é™…ä¾‹å­ï¼š</strong></p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¼ ç»Ÿçš„ C++ ç±»è°ƒç”¨ï¼ˆåªèƒ½åœ¨åŒä¸€è¿›ç¨‹ä¸­ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MyClass obj;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DoSomething</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// COM æ¥å£è°ƒç”¨ï¼ˆå¯ä»¥è·¨è¿›ç¨‹ã€è·¨è¯­è¨€ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IMyInterface</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pInterface </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nullptr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CreateMyComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pInterface);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å¯èƒ½æ¥è‡ªå¦ä¸€ä¸ª DLL æˆ–è¿›ç¨‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pInterface-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DoSomething</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></div><h3 id="ğŸ¯-ä»€ä¹ˆæ˜¯-winrt-ä¸-com-çš„å…³ç³»" tabindex="-1">ğŸ¯ ä»€ä¹ˆæ˜¯ WinRTï¼Ÿä¸ COM çš„å…³ç³» <a class="header-anchor" href="#ğŸ¯-ä»€ä¹ˆæ˜¯-winrt-ä¸-com-çš„å…³ç³»" aria-label="Permalink to &quot;ğŸ¯ ä»€ä¹ˆæ˜¯ WinRTï¼Ÿä¸ COM çš„å…³ç³»&quot;">â€‹</a></h3><p><strong>WinRT (Windows Runtime)</strong> æ˜¯åŸºäº COM çš„ç°ä»£åŒ– API ç³»ç»Ÿï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¼ ç»Ÿ Win32 APIï¼ˆC é£æ ¼ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HWND hwnd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CreateWindow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(...);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SetWindowText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hwnd, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">L&quot;Hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// WinRT APIï¼ˆé¢å‘å¯¹è±¡ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MainWindow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Title</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">L&quot;Hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p><strong>WinRT çš„ä¼˜åŠ¿ï¼š</strong></p><ul><li><strong>ç±»å‹å®‰å…¨</strong>ï¼šå¼ºç±»å‹æ£€æŸ¥ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯</li><li><strong>ç°ä»£è¯­æ³•</strong>ï¼šæ”¯æŒå±æ€§ã€äº‹ä»¶ã€å¼‚æ­¥æ“ä½œ</li><li><strong>è‡ªåŠ¨å†…å­˜ç®¡ç†</strong>ï¼šå¼•ç”¨è®¡æ•°ï¼Œæ— éœ€æ‰‹åŠ¨ Release</li><li><strong>è·¨å¹³å°</strong>ï¼šå¯ä»¥åœ¨ Windowsã€Xboxã€HoloLens ç­‰å¹³å°ä½¿ç”¨</li></ul><h3 id="ğŸ—ï¸-ä»€ä¹ˆæ˜¯-abi-application-binary-interface" tabindex="-1">ğŸ—ï¸ ä»€ä¹ˆæ˜¯ ABI (Application Binary Interface)ï¼Ÿ <a class="header-anchor" href="#ğŸ—ï¸-ä»€ä¹ˆæ˜¯-abi-application-binary-interface" aria-label="Permalink to &quot;ğŸ—ï¸ ä»€ä¹ˆæ˜¯ ABI (Application Binary Interface)ï¼Ÿ&quot;">â€‹</a></h3><p><strong>ABI</strong> å®šä¹‰äº†ä¸åŒæ¨¡å—ä¹‹é—´å¦‚ä½•åœ¨äºŒè¿›åˆ¶å±‚é¢è¿›è¡Œäº¤äº’ï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// C++/WinRT çš„é«˜çº§æ¥å£ï¼ˆå¼€å‘è€…ä½¿ç”¨çš„ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::hstring text </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> L&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> length </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> text.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ABI å±‚ï¼ˆåº•å±‚ COM æ¥å£ï¼Œå®é™…è°ƒç”¨çš„ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HSTRING abi_string;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WindowsCreateString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">L&quot;Hello World&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">abi_string);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">UINT32 abi_length;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WindowsGetStringLen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abi_string, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">abi_length);</span></span></code></pre></div><p><strong>ä¸ºä»€ä¹ˆéœ€è¦ ABIï¼Ÿ</strong></p><ul><li><strong>äºŒè¿›åˆ¶å…¼å®¹</strong>ï¼šç¡®ä¿ä¸åŒç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç å¯ä»¥äº’æ“ä½œ</li><li><strong>ç¨³å®šæ¥å£</strong>ï¼šABI ä¸ä¼šå› ä¸º C++ ç‰ˆæœ¬æ›´æ–°è€Œæ”¹å˜</li><li><strong>è·¨è¯­è¨€è°ƒç”¨</strong>ï¼šå…¶ä»–è¯­è¨€ï¼ˆå¦‚ C#ï¼‰å¯ä»¥è°ƒç”¨ç›¸åŒçš„ ABI</li></ul><h3 id="ğŸ§ -ä»€ä¹ˆæ˜¯æ™ºèƒ½æŒ‡é’ˆ-ä¸ºä»€ä¹ˆé‡è¦" tabindex="-1">ğŸ§  ä»€ä¹ˆæ˜¯æ™ºèƒ½æŒ‡é’ˆï¼Ÿä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ <a class="header-anchor" href="#ğŸ§ -ä»€ä¹ˆæ˜¯æ™ºèƒ½æŒ‡é’ˆ-ä¸ºä»€ä¹ˆé‡è¦" aria-label="Permalink to &quot;ğŸ§  ä»€ä¹ˆæ˜¯æ™ºèƒ½æŒ‡é’ˆï¼Ÿä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ&quot;">â€‹</a></h3><p><strong>æ™ºèƒ½æŒ‡é’ˆ</strong> æ˜¯è‡ªåŠ¨ç®¡ç†å†…å­˜çš„æŒ‡é’ˆåŒ…è£…å™¨ï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¼ ç»Ÿè£¸æŒ‡é’ˆï¼ˆå®¹æ˜“å‡ºé”™ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MyClass</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ptr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ... ä½¿ç”¨ ptr ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ptr;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å¿˜è®°è°ƒç”¨ä¼šå†…å­˜æ³„æ¼</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ™ºèƒ½æŒ‡é’ˆï¼ˆè‡ªåŠ¨ç®¡ç†ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::unique_ptr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MyClass</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ptr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make_unique</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MyClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ... ä½¿ç”¨ ptr ...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ææ„æ—¶è‡ªåŠ¨åˆ é™¤ï¼Œæ— éœ€æ‰‹åŠ¨ delete</span></span></code></pre></div><p><strong>C++/WinRT ä¸­çš„æ™ºèƒ½æŒ‡é’ˆï¼š</strong></p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// winrt::com_ptr - ç®¡ç† COM å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::com_ptr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IMyInterface</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ptr;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CreateMyComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ptr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">put</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // è·å–æ¥å£</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è‡ªåŠ¨è°ƒç”¨ Release()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// WinRT å¯¹è±¡æœ¬èº«å°±æ˜¯æ™ºèƒ½æŒ‡é’ˆ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::hstring str </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> L&quot;Hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å†…éƒ¨è‡ªåŠ¨ç®¡ç†å¼•ç”¨è®¡æ•°</span></span></code></pre></div><h3 id="ğŸ“-ä»€ä¹ˆæ˜¯å¼•ç”¨è®¡æ•°" tabindex="-1">ğŸ“ ä»€ä¹ˆæ˜¯å¼•ç”¨è®¡æ•°ï¼Ÿ <a class="header-anchor" href="#ğŸ“-ä»€ä¹ˆæ˜¯å¼•ç”¨è®¡æ•°" aria-label="Permalink to &quot;ğŸ“ ä»€ä¹ˆæ˜¯å¼•ç”¨è®¡æ•°ï¼Ÿ&quot;">â€‹</a></h3><p><strong>å¼•ç”¨è®¡æ•°</strong> æ˜¯ä¸€ç§å†…å­˜ç®¡ç†æŠ€æœ¯ï¼Œè¿½è¸ªæœ‰å¤šå°‘ä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¼•ç”¨è®¡æ•°ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RefCountedObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    mutable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> refCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // åˆå§‹å¼•ç”¨è®¡æ•°ä¸º 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AddRef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">refCount; }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Release</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">refCount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">delete</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RefCountedObject</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> obj </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RefCountedObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // refCount = 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddRef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // refCount = 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Release</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // refCount = 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Release</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // refCount = 0, å¯¹è±¡è¢«åˆ é™¤</span></span></code></pre></div><p><strong>åœ¨ C++/WinRT ä¸­çš„åº”ç”¨ï¼š</strong></p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// WinRT å¯¹è±¡è‡ªåŠ¨ç®¡ç†å¼•ç”¨è®¡æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> obj1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MyClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // refCount = 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> obj2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> obj1;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       // refCount = 2ï¼ˆè‡ªåŠ¨ AddRefï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nullptr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                         // refCount = 1ï¼ˆè‡ªåŠ¨ Releaseï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// obj2 è¶…å‡ºä½œç”¨åŸŸæ—¶ï¼ŒrefCount = 0ï¼Œå¯¹è±¡è‡ªåŠ¨é”€æ¯</span></span></code></pre></div><h2 id="ä¸‹é¢æˆ‘ä»¬å°†ä»¥-preferredheightoption-ä¸ºä¾‹-å¸¦ä½ è®²è§£-cpp-winrt-æ˜¯å¦‚ä½•è½¬æ¢å‚æ•°ç»™-com-çš„-ä»¥åŠç›¸å…³ä½¿ç”¨æ¨¡æ¿å…ƒç¼–ç¨‹æ¦‚å¿µ" tabindex="-1">ä¸‹é¢æˆ‘ä»¬å°†ä»¥ <code>PreferredHeightOption()</code> ä¸ºä¾‹ï¼Œå¸¦ä½ è®²è§£ cpp/winRT æ˜¯å¦‚ä½•è½¬æ¢å‚æ•°ç»™ COM çš„ï¼Œä»¥åŠç›¸å…³ä½¿ç”¨æ¨¡æ¿å…ƒç¼–ç¨‹æ¦‚å¿µï¼š <a class="header-anchor" href="#ä¸‹é¢æˆ‘ä»¬å°†ä»¥-preferredheightoption-ä¸ºä¾‹-å¸¦ä½ è®²è§£-cpp-winrt-æ˜¯å¦‚ä½•è½¬æ¢å‚æ•°ç»™-com-çš„-ä»¥åŠç›¸å…³ä½¿ç”¨æ¨¡æ¿å…ƒç¼–ç¨‹æ¦‚å¿µ" aria-label="Permalink to &quot;ä¸‹é¢æˆ‘ä»¬å°†ä»¥ `PreferredHeightOption()` ä¸ºä¾‹ï¼Œå¸¦ä½ è®²è§£ cpp/winRT æ˜¯å¦‚ä½•è½¬æ¢å‚æ•°ç»™ COM çš„ï¼Œä»¥åŠç›¸å…³ä½¿ç”¨æ¨¡æ¿å…ƒç¼–ç¨‹æ¦‚å¿µï¼š&quot;">â€‹</a></h2><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> D</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> consume_Microsoft_UI_Windowing_IAppWindowTitleBar2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">D</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PreferredHeightOption</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Microsoft</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Windowing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TitleBarHeightOption</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> constexpr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::is_same_v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Microsoft</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Windowing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::IAppWindowTitleBar2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> //æ³¨æ„å–å</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::hresult _winrt_cast_result_code;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        auto</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _winrt_casted_result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> impl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">try_as_with_reason</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Microsoft</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Windowing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IAppWindowTitleBar2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">D</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static_cast&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const*&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), _winrt_cast_result_code);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        check_hresult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(_winrt_cast_result_code);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        auto</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _winrt_abi_type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">abi_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Microsoft</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Windowing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::IAppWindowTitleBar2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_winrt_casted_result;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        check_hresult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(_winrt_abi_type-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">put_PreferredHeightOption</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static_cast&lt;int32_t&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value)));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        auto</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _winrt_abi_type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">abi_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Microsoft</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Windowing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::IAppWindowTitleBar2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        check_hresult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(_winrt_abi_type-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">put_PreferredHeightOption</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static_cast&lt;int32_t&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value)));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><em>è¿™é‡Œåªè®²éƒ¨åˆ†ï¼Œåé¢ä¹Ÿä¼šæ¶‰åŠåˆ°å…¶ä»–éƒ¨åˆ†ã€‚</em></p><p>è¿™ä¹ˆé•¿çš„å‡½æ•°ï¼ï¼Ÿåˆ«æ€¥ï¼Œæˆ‘ä»¬æ…¢æ…¢æ¥ææ¸…æ¥šã€‚</p><ul><li>é¦–å…ˆä»ç¬¬ä¸€è¡Œåå­—å…¥æ‰‹ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ¨¡æ¿ç±»å‹Dã€‚ <ul><li>æ³¨æ„æˆ‘ä»¬åœ¨æ­¤å¥æ²¡æœ‰è¿›è¡Œé€šå¸¸çš„æ¢è¡Œï¼Œç›´æ¥å¼€å§‹å®šä¹‰å‡½æ•°ï¼Œè¿™åœ¨æ¨¡æ¿ä¸­æ˜¯å¯è¡Œçš„ã€‚è¿™æ˜¯ç”± WinRTç”Ÿæˆçš„ cpp ä»£ç çš„é£æ ¼ï¼ˆæ¨¡æ¿å£°æ˜ç´§è·Ÿå‡½æ•°å®šä¹‰ï¼‰ï¼Œä¸ºäº†ç´§å‡‘å¹¶ç¼©çŸ­æ–‡ä»¶é•¿åº¦ã€‚</li><li><code>auto</code>:ä½ è¦çŸ¥é“ä¸€èˆ¬å‡½æ•°çš„<strong>è¿”å›ç±»å‹</strong>å¿…é¡»<strong>æ˜¾å¼</strong>åœ°åœ¨<strong>å®šä¹‰</strong>æ—¶æŒ‡å®šï¼Œé™¤äº†è¿™ç§æ–¹æ³•ï¼Œè¿˜æœ‰ç”± cpp11 å¼•å…¥çš„<strong>å°¾éš/å°¾ç½®è¿”å›ç±»å‹</strong>ï¼šä½¿ç”¨<code>auto</code>å…³é”®å­—å ä½ï¼ŒçœŸæ­£çš„è¿”å›ç±»å‹åœ¨ç´§è·Ÿåœ¨å‚æ•°åˆ—è¡¨åé¢çš„<code>-&gt;</code>åé¢ç¬¦å·æŒ‡å®šï¼Œå³å¯ä»¥ç”±æœ€åå‡½æ•°çš„è¿”å›å€¼ç±»å‹æ¥æŒ‡å®šå½“å‰å‡½æ•°è¿”å›å€¼ç±»å‹ã€‚äº¦èƒ½äº†è§£åˆ°ä¸æ¨¡æ¿ä½¿ç”¨ï¼Œèƒ½é™ä½å¤§é‡é‡å¤çš„ä»£ç ç¼–å†™ã€‚</li><li>åæ¥åœ¨ C++14 å¼•å…¥äº† <code>auto</code> ä½œä¸ºå‡½æ•°è¿”å›ç±»å‹ çš„åŠŸèƒ½ã€‚å‰ææ˜¯å‡½æ•°ä½“ä¸­åªæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹ç›¸åŒçš„ return è¯­å¥ï¼Œç¼–è¯‘å™¨å°±èƒ½æ¨å¯¼å‡ºè¿”å›ç±»å‹ã€‚æ­¤å³ä¸ºæ³›å‹ï¼Œæé«˜äº†ç¼–å†™æ•ˆç‡ï¼Œä½†é™ä½äº†å¯è¯»æ€§ã€‚</li><li>æ­¤å‡½æ•°æ²¡æœ‰è¿”å›ç±»å‹ï¼Œæ•…ç¼–è¯‘å™¨æ¨å¯¼è¿”å›å€¼ä¸º void ç±»å‹ã€‚é‚£é—®é¢˜æ¥äº†ï¼Œä¸€ä¸ªç®€å•çš„ void ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ auto æ¥è®©ç¼–è¯‘å™¨æ¨å¯¼ï¼Ÿè¿™å³æ˜¯æ¨¡æ¿ç¼–ç¨‹çš„å¼ºå¤§ä¹‹å¤„ã€‚ä½¿ç”¨ <code>auto</code> å¯ä»¥è®©æ¨¡æ¿æ›´çµæ´»ï¼Œå¦‚æœå°†æ¥éœ€è¦è¿”å›æŸä¸ªå€¼ï¼ˆæ¯”å¦‚é“¾å¼è°ƒç”¨ï¼‰ï¼Œåªéœ€è¦æ·»åŠ  <code>return</code> è¯­å¥ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹å‡½æ•°ç­¾åã€‚å½“ç„¶è¿™ä¹Ÿæ˜¯ä¸ºäº† cpp/winrt æ¡†æ¶çš„ä¸€è‡´æ€§ã€‚</li><li>ä»å®Œæ•´å‡½æ•°åæˆ‘ä»¬å¾—åˆ°äº†<code>PreferredHeightOption</code>æ˜¯<code>consume_Microsoft_UI_Windowing_IAppWindowTitleBar2&lt;D&gt;</code>ç±»çš„æˆå‘˜ã€‚å¯è§å…¶æ‰€åœ¨ç±»æœ¬èº«ä¹Ÿæ˜¯æ¨¡æ¿ç±»ã€‚</li><li>å‚æ•°ï¼šç±»å‹ä¸º<code>winrt::Microsoft::UI::Windowing::TitleBarHeightOption</code>ï¼ˆä»æšä¸¾ç±»å‹ä¼ æ¥çš„æšä¸¾æ•°å€¼ï¼‰ï¼Œå‚æ•°æ˜¯ä¸€ä¸ª const&amp; å¼•ç”¨ï¼Œé¿å…æ‹·è´ã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰ï¼Œå¼ºçƒˆå»ºè®®å­¦ä¹ <a href="/vitepresspages/C++/memory1.html">C++ ç§»åŠ¨è¯­ä¹‰</a>ã€‚</li><li></li></ul></li><li><code>if constexpr()</code> æ˜¯ C++17 å¼€å§‹å¼•å…¥çš„<strong>ç¼–è¯‘æœŸæ¡ä»¶åˆ¤æ–­</strong>è¯­å¥ï¼Œåœ¨ç°ä»£ cpp <strong>æ¨¡æ¿å…ƒç¼–ç¨‹</strong>ä¸­å¸¸è§ï¼Œå°¤å…¶ WinRT å¼ºç±»å‹å¤šæ¥å£æƒ…å†µã€‚åœ¨()å†…å®¹ä¸º false æ—¶ï¼Œä¸ºå‡çš„ä¸æ‰§è¡Œçš„åˆ†æ”¯ä»£ç å°†è·³è¿‡ç¼–è¯‘ï¼Œéè¿è¡Œæ—¶åˆ¤æ–­ã€‚ è®©æ¨¡æ¿ä»£ç å¯ä»¥æ ¹æ®ç±»å‹å‚æ•°ï¼Œé€‰æ‹©æ€§åœ°ç¼–è¯‘ä¸åŒçš„å®ç°ï¼Œé¿å…æ— æ•ˆä»£ç å¯¼è‡´çš„ç¼–è¯‘é”™è¯¯ã€‚é€šè¿‡ä½¿ç”¨ä½äºæ ‡å‡†åº“ &lt;type_traits&gt; çš„ <code>srd::is_same_v&lt;A,B&gt;</code> ï¼Œåœ¨ç¼–è¯‘æ—¶åˆ¤æ–­ABç±»å‹æ˜¯å¦å®Œå…¨ç›¸åŒï¼Œè¿”å›ä¸€ä¸ª bool ç±»å‹ã€‚å¦‚æœä¸æ˜¯ï¼Œèµ° if åˆ†æ”¯ï¼›å¦åˆ™èµ° else åˆ†æ”¯ã€‚è¾ƒä¸ºç®€å•ï¼Œæ•…ä¸å†ä¸¾ä¾‹è®²è§£ã€‚</li><li>é‚£ç°åœ¨æ¥çœ‹å…·ä½“æ¥çœ‹éƒ½åŒºåˆ†äº†ä»€ä¹ˆï¼š <ul><li><p>å½“ D ä¸æ˜¯ IAppWindowTitleBar2 è¿›å…¥ if åˆ†æ”¯ã€‚</p><ul><li><p>é¦–å…ˆå£°æ˜äº†ä¸ª <code>hresult</code> ç±»å‹å˜é‡ã€‚ä½¿ç”¨<code>_winrt_cast_result_code</code>æ¥æ”¶ç±»å‹è½¬æ¢çš„ç»“æœç ï¼ˆHRESULTï¼‰ï¼Œåˆ¤æ–­è½¬æ¢æ˜¯å¦æˆåŠŸã€‚</p></li><li><p>çœ‹æ¸…æ‹¬å·ï¼Œæˆ‘ä»¬ä½¿ç”¨ auto æ¨å¯¼å‡ºä½äº = åé¢<code>impl::try_as_with_reason&lt;...&gt;()</code>å‡½æ•°çš„è¿”å›å€¼ï¼Œå¹¶ä½¿ç”¨<code>_winrt_casted_result</code>æ¥æ”¶ã€‚</p></li><li><p><code>impl::try_as_with_reason&lt;...&gt;()</code>:<span style="color:red;font-weight:bold;">try_as_with_reason</span>æ˜¯ WinRT è¾…åŠ©å‡½æ•°ï¼Œå°è¯•å°†å½“å‰ this æŒ‡é’ˆï¼ˆç±»å‹ D çš„ const æŒ‡é’ˆï¼‰è½¬æ¢ä¸º IAppWindowTitleBar2 <strong>æ¥å£æŒ‡é’ˆ</strong>ï¼Œå¹¶å°†ç»“æœä¿å­˜åœ¨ _winrt_casted_resultï¼ŒHRESULT ä¿å­˜åœ¨ <code>_winrt_cast_result_code</code>ã€‚</p><ul><li>è¾…åŠ©å‡½æ•°æ˜¯æŒ‡å¸®åŠ©å®ŒæˆæŸäº›é‡å¤ã€åº•å±‚ã€å¤æ‚æ“ä½œçš„å·¥å…·æ€§å‡½æ•°ï¼Œè®©è°ƒç”¨è€…ä¸ç”¨å…³å¿ƒç»†èŠ‚ã€‚åœ¨ C++/WinRT æ¡†æ¶é‡Œï¼Œå¾ˆå¤šåº•å±‚ COM æ“ä½œéƒ½è¢«å°è£…æˆäº†&quot;è¾…åŠ©å‡½æ•°&quot;ï¼Œæ¯”å¦‚ç±»å‹è½¬æ¢ã€é”™è¯¯å¤„ç†ã€å†…å­˜ç®¡ç†ç­‰ã€‚</li><li><code>try_as_with_reason</code>ç©¶ç«Ÿå¹²äº†ä»€ä¹ˆï¼Ÿ<code>try_as_with_reason&lt;Target, Source&gt;(pointer, hresult&amp;)</code> æ˜¯ C++/WinRT æ¡†æ¶é‡Œç”¨äº <strong>æ¥å£ç±»å‹è½¬æ¢ï¼ˆQueryInterfaceï¼‰</strong> çš„å·¥å…·å‡½æ•°ï¼Œå°è¯•æŠŠ pointer è½¬æ¢ä¸º Target æ¥å£ï¼Œè¿”å›è½¬æ¢åçš„<strong>æ™ºèƒ½æŒ‡é’ˆ</strong>ï¼Œå¹¶æŠŠ HRESULT å­˜è¿› <code>hresult&amp;</code> è¿™ä¸ªå¼•ç”¨é‡Œï¼Œè¿™æ ·ä½ å°±é€šè¿‡åé¢çš„<code>check_hresult()</code>çŸ¥é“è½¬æ¢æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œå¹¶èƒ½è·å¾—å¤±è´¥çš„åŸå› ã€‚</li></ul></li><li><p>é€šè¿‡<code>check_hresult()</code>æ£€æŸ¥è½¬æ¢æƒ…å†µã€‚ä¸ºä»€ä¹ˆè¦åœ¨è¿™é‡Œæ£€æŸ¥ï¼Ÿå› ä¸ºå…¶åº•å±‚æ˜¯åŸºäº COM å’Œ ABI çš„ï¼Œå…¶å†…éƒ¨å‡ºé”™ä¸ä¾¿äºé”™è¯¯å®šä½ã€‚</p></li><li><p><code>abi_t&lt;...&gt;</code>è¯¦ç»†è§£æï¼š</p><ul><li><code>abi_t</code> æ˜¯ C++/WinRT é‡Œè¡¨ç¤ºåº•å±‚ ABI ç±»å‹çš„ç±»å‹åˆ«åï¼Œç­‰åŒäº abi_typeã€‚å…¶å®šä¹‰ä¸ºï¼š<code>template &lt;typename T&gt; using abi_t = typename T::abi_type;</code>ã€‚</li><li>åœ¨ C++/WinRT ä¸­ï¼Œå¯¹äº WinRT æ¥å£æ¥è¯´ï¼Œ<code>::abi_type</code> (å³ <code>abi_t</code>) å°±æ˜¯ <code>Interface*</code>ï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘ COM æ¥å£çš„è£¸æŒ‡é’ˆã€‚</li><li>ä¸ºä»€ä¹ˆéœ€è¦ ABI ç±»å‹ï¼Ÿå› ä¸º C++/WinRT çš„é«˜çº§åŒ…è£…ç±»å‹ï¼ˆå¦‚ <code>IAppWindowTitleBar2</code>ï¼‰æœ€ç»ˆéœ€è¦è½¬æ¢ä¸ºåº•å±‚çš„ COM æ¥å£æŒ‡é’ˆæ‰èƒ½ä¸ Windows ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚ABIï¼ˆApplication Binary Interfaceï¼‰æ˜¯åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ¥å£ï¼Œæ˜¯ä¸åŒæ¨¡å—é—´è°ƒç”¨çš„çº¦å®šã€‚</li><li><code>*(abi_t&lt;winrt::Microsoft::UI::Windowing::IAppWindowTitleBar2&gt;**)&amp;_winrt_casted_result</code> è¿™è¡Œä»£ç åšäº†ä»€ä¹ˆï¼Ÿ <ol><li><code>&amp;_winrt_casted_result</code>ï¼šè·å–æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡çš„åœ°å€</li><li><code>(abi_t&lt;...&gt;**)</code>ï¼šå°†åœ°å€å¼ºåˆ¶è½¬æ¢ä¸ºæŒ‡å‘ ABI ç±»å‹æŒ‡é’ˆçš„æŒ‡é’ˆ</li><li><code>*(...)</code>ï¼šè§£å¼•ç”¨ï¼Œè·å¾— ABI ç±»å‹çš„è£¸æŒ‡é’ˆ</li></ol></li><li>è¿™ç§å¤æ‚çš„æŒ‡é’ˆæ“ä½œæ˜¯å› ä¸º C++/WinRT éœ€è¦ä»é«˜çº§æ™ºèƒ½æŒ‡é’ˆä¸­æå–å‡ºåº•å±‚çš„ COM æ¥å£æŒ‡é’ˆã€‚</li></ul></li><li><p><code>static_cast&lt;D const*&gt;(this)</code> è¯¦ç»†è§£æï¼š</p><ul><li><code>static_cast</code> æ˜¯ C++ ä¸­çš„<strong>ç¼–è¯‘æ—¶ç±»å‹è½¬æ¢</strong>æ“ä½œç¬¦ï¼Œç”¨äºç›¸å…³ç±»å‹ä¹‹é—´çš„è½¬æ¢ã€‚</li><li>åœ¨æ¨¡æ¿ä¸Šä¸‹æ–‡ä¸­ï¼Œ<code>this</code> æŒ‡é’ˆçš„å®é™…ç±»å‹æ˜¯ <code>consume_Microsoft_UI_Windowing_IAppWindowTitleBar2&lt;D&gt;*</code>ã€‚</li><li>é€šè¿‡ <code>static_cast&lt;D const*&gt;(this)</code> å°† <code>this</code> æŒ‡é’ˆè½¬æ¢ä¸º <code>D const*</code> ç±»å‹ã€‚</li><li>ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªè½¬æ¢ï¼Ÿå› ä¸º <code>try_as_with_reason</code> éœ€è¦æ¥æ”¶å…·ä½“çš„æ´¾ç”Ÿç±»å‹æŒ‡é’ˆï¼Œè€Œä¸æ˜¯åŸºç±»æŒ‡é’ˆã€‚è¿™æ ·å¯ä»¥ç¡®ä¿ç±»å‹è½¬æ¢çš„å‡†ç¡®æ€§ã€‚</li><li><code>const*</code> è¡¨ç¤ºæŒ‡å‘å¸¸é‡å¯¹è±¡çš„æŒ‡é’ˆï¼Œä¿è¯åœ¨è½¬æ¢è¿‡ç¨‹ä¸­ä¸ä¼šä¿®æ”¹å¯¹è±¡çŠ¶æ€ï¼Œç¬¦åˆå‡½æ•°çš„ <code>const</code> ä¿®é¥°ç¬¦ã€‚</li></ul></li><li><p><code>check_hresult(_winrt_abi_type-&gt;put_PreferredHeightOption(static_cast&lt;int32_t&gt;(value)))</code> è¯¦ç»†è§£æï¼š</p><ul><li>è¿™æ˜¯æœ€ç»ˆçš„ COM æ–¹æ³•è°ƒç”¨ã€‚<code>put_PreferredHeightOption</code> æ˜¯ COM æ¥å£ä¸­çš„ setter æ–¹æ³•ã€‚</li><li><code>static_cast&lt;int32_t&gt;(value)</code>ï¼šå°†å¼ºç±»å‹æšä¸¾ <code>TitleBarHeightOption</code> è½¬æ¢ä¸º 32 ä½æ•´æ•°ã€‚ <ul><li>ä¸ºä»€ä¹ˆè¦è½¬æ¢ï¼Ÿå› ä¸º COM æ¥å£å®šä¹‰çš„å‚æ•°ç±»å‹æ˜¯ <code>int32_t</code>ï¼Œè€Œ C++/WinRT ä½¿ç”¨å¼ºç±»å‹æšä¸¾æä¾›ç±»å‹å®‰å…¨ã€‚</li><li>æšä¸¾å€¼ï¼ˆå¦‚ <code>TitleBarHeightOption::Standard</code> æˆ– <code>TitleBarHeightOption::Tall</code>ï¼‰åœ¨åº•å±‚å­˜å‚¨ä¸ºæ•´æ•°å¸¸é‡ã€‚</li><li>COM å±‚é¢åªè®¤è¯†åŸºç¡€æ•°æ®ç±»å‹ï¼Œä¸è®¤è¯† C++ çš„æšä¸¾ç±»å‹ã€‚</li></ul></li><li><code>-&gt;put_PreferredHeightOption(...)</code>ï¼šé€šè¿‡ COM æ¥å£æŒ‡é’ˆè°ƒç”¨æ–¹æ³•ï¼Œè®¾ç½®æ ‡é¢˜æ é«˜åº¦é€‰é¡¹ã€‚</li><li><code>check_hresult(...)</code>ï¼šæ£€æŸ¥ COM æ–¹æ³•çš„è¿”å›å€¼ï¼ˆHRESULTï¼‰ï¼Œå¦‚æœå¤±è´¥ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li></ul></li></ul></li><li><p>å½“ D å°±æ˜¯ IAppWindowTitleBar2 æ—¶ï¼Œè¿›å…¥ else åˆ†æ”¯ï¼š</p><ul><li><code>auto const _winrt_abi_type = *(abi_t&lt;winrt::Microsoft::UI::Windowing::IAppWindowTitleBar2&gt;**)this;</code><ul><li>ä¸ if åˆ†æ”¯ç±»ä¼¼ï¼Œä½†è¿™é‡Œç›´æ¥ä» <code>this</code> æŒ‡é’ˆæå– ABI ç±»å‹ï¼Œæ— éœ€è¿›è¡Œæ¥å£è½¬æ¢ã€‚</li><li>å› ä¸º D å·²ç»æ˜¯ç›®æ ‡æ¥å£ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è®¿é—®ï¼Œé¿å…äº†é¢å¤–çš„ <code>QueryInterface</code> å¼€é”€ã€‚</li></ul></li><li><code>check_hresult(_winrt_abi_type-&gt;put_PreferredHeightOption(static_cast&lt;int32_t&gt;(value)));</code><ul><li>ç›´æ¥è°ƒç”¨ COM æ–¹æ³•ï¼Œé€»è¾‘ä¸ if åˆ†æ”¯ç›¸åŒã€‚</li></ul></li></ul></li></ul></li></ul><h2 id="æ·±å…¥ç†è§£-ä¸ºä»€ä¹ˆéœ€è¦è¿™æ ·å¤æ‚çš„å®ç°" tabindex="-1">æ·±å…¥ç†è§£ï¼šä¸ºä»€ä¹ˆéœ€è¦è¿™æ ·å¤æ‚çš„å®ç°ï¼Ÿ <a class="header-anchor" href="#æ·±å…¥ç†è§£-ä¸ºä»€ä¹ˆéœ€è¦è¿™æ ·å¤æ‚çš„å®ç°" aria-label="Permalink to &quot;æ·±å…¥ç†è§£ï¼šä¸ºä»€ä¹ˆéœ€è¦è¿™æ ·å¤æ‚çš„å®ç°ï¼Ÿ&quot;">â€‹</a></h2><h3 id="_1-ç±»å‹å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–çš„å¹³è¡¡" tabindex="-1">1. <strong>ç±»å‹å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–çš„å¹³è¡¡</strong> <a class="header-anchor" href="#_1-ç±»å‹å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–çš„å¹³è¡¡" aria-label="Permalink to &quot;1. **ç±»å‹å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–çš„å¹³è¡¡**&quot;">â€‹</a></h3><ul><li>C++/WinRT æä¾›å¼ºç±»å‹çš„ç°ä»£ C++ æ¥å£ï¼Œä½†åº•å±‚å¿…é¡»ä¸ COM å…¼å®¹ã€‚</li><li>é€šè¿‡æ¨¡æ¿å…ƒç¼–ç¨‹ï¼Œåœ¨ç¼–è¯‘æ—¶å†³å®šæœ€ä¼˜çš„ä»£ç è·¯å¾„ï¼Œé¿å…è¿è¡Œæ—¶å¼€é”€ã€‚</li></ul><h3 id="_2-æ¥å£ç»§æ‰¿ä¸å¤šæ€çš„å¤„ç†" tabindex="-1">2. <strong>æ¥å£ç»§æ‰¿ä¸å¤šæ€çš„å¤„ç†</strong> <a class="header-anchor" href="#_2-æ¥å£ç»§æ‰¿ä¸å¤šæ€çš„å¤„ç†" aria-label="Permalink to &quot;2. **æ¥å£ç»§æ‰¿ä¸å¤šæ€çš„å¤„ç†**&quot;">â€‹</a></h3><ul><li>WinRT æ¥å£æœ‰å¤æ‚çš„ç»§æ‰¿å…³ç³»ï¼Œä¸€ä¸ªå¯¹è±¡å¯èƒ½å®ç°å¤šä¸ªæ¥å£ã€‚</li><li><code>if constexpr</code> ç¡®ä¿åœ¨ç¼–è¯‘æ—¶é€‰æ‹©æ­£ç¡®çš„ç±»å‹è½¬æ¢ç­–ç•¥ã€‚</li></ul><h3 id="_3-com-äº’æ“ä½œæ€§" tabindex="-1">3. <strong>COM äº’æ“ä½œæ€§</strong> <a class="header-anchor" href="#_3-com-äº’æ“ä½œæ€§" aria-label="Permalink to &quot;3. **COM äº’æ“ä½œæ€§**&quot;">â€‹</a></h3><ul><li>æ‰€æœ‰ WinRT å¯¹è±¡æœ€ç»ˆéƒ½æ˜¯ COM å¯¹è±¡ï¼Œéœ€è¦éµå¾ª COM çš„è°ƒç”¨çº¦å®šã€‚</li><li>ABI å±‚ç¡®ä¿äº†è·¨æ¨¡å—ã€è·¨è¯­è¨€çš„äº’æ“ä½œæ€§ã€‚</li></ul><h2 id="é«˜çº§æ¨¡æ¿å…ƒç¼–ç¨‹æŠ€æœ¯æ·±åº¦åˆçº§è§£æè®¨è®º" tabindex="-1">é«˜çº§æ¨¡æ¿å…ƒç¼–ç¨‹æŠ€æœ¯æ·±åº¦åˆçº§è§£æè®¨è®º <a class="header-anchor" href="#é«˜çº§æ¨¡æ¿å…ƒç¼–ç¨‹æŠ€æœ¯æ·±åº¦åˆçº§è§£æè®¨è®º" aria-label="Permalink to &quot;é«˜çº§æ¨¡æ¿å…ƒç¼–ç¨‹æŠ€æœ¯æ·±åº¦åˆçº§è§£æè®¨è®º&quot;">â€‹</a></h2><h3 id="_4-crtp-curiously-recurring-template-pattern-åœ¨-c-winrt-ä¸­çš„åº”ç”¨" tabindex="-1">4. <strong>CRTP (Curiously Recurring Template Pattern) åœ¨ C++/WinRT ä¸­çš„åº”ç”¨</strong> <a class="header-anchor" href="#_4-crtp-curiously-recurring-template-pattern-åœ¨-c-winrt-ä¸­çš„åº”ç”¨" aria-label="Permalink to &quot;4. **CRTP (Curiously Recurring Template Pattern) åœ¨ C++/WinRT ä¸­çš„åº”ç”¨**&quot;">â€‹</a></h3><p>C++/WinRT å¤§é‡ä½¿ç”¨äº† CRTP æ¨¡å¼ï¼Œè¿™æ˜¯ä¸€ç§è®©åŸºç±»äº†è§£æ´¾ç”Ÿç±»ç±»å‹çš„æŠ€æœ¯ï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// CRTP åŸºæœ¬æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> D</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Base</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> someMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        static_cast&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">derivedMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Derived</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Base</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Derived</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> derivedMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /* å…·ä½“å®ç° */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ<code>consume_Microsoft_UI_Windowing_IAppWindowTitleBar2&lt;D&gt;</code> å°±æ˜¯é‡‡ç”¨ CRTP æ¨¡å¼ï¼š</p><ul><li><code>D</code> æ˜¯å®é™…çš„æ´¾ç”Ÿç±»ç±»å‹</li><li>åŸºç±»é€šè¿‡æ¨¡æ¿å‚æ•°çŸ¥é“æ´¾ç”Ÿç±»çš„å…·ä½“ç±»å‹</li><li>è¿™ä½¿å¾—åŸºç±»å¯ä»¥è°ƒç”¨æ´¾ç”Ÿç±»çš„ç‰¹å®šæ–¹æ³•ï¼Œå®ç°é™æ€å¤šæ€</li></ul><p><strong>CRTP çš„ä¼˜åŠ¿ï¼š</strong></p><ul><li><strong>é›¶è¿è¡Œæ—¶å¼€é”€</strong>ï¼šç¼–è¯‘æ—¶å°±ç¡®å®šäº†è°ƒç”¨å…³ç³»ï¼Œæ²¡æœ‰è™šå‡½æ•°è¡¨æŸ¥æ‰¾</li><li><strong>ç±»å‹å®‰å…¨</strong>ï¼šç¼–è¯‘æ—¶æ£€æŸ¥ç±»å‹åŒ¹é…</li><li><strong>æ¥å£ç»Ÿä¸€</strong>ï¼šæä¾›ç»Ÿä¸€çš„åŸºç±»æ¥å£ï¼ŒåŒæ—¶ä¿æŒæ´¾ç”Ÿç±»çš„ç‰¹åŒ–èƒ½åŠ›</li></ul><h3 id="_5-sfinae-ä¸-enable-if-çš„æ·±å…¥åº”ç”¨" tabindex="-1">5. <strong>SFINAE ä¸ enable_if çš„æ·±å…¥åº”ç”¨</strong> <a class="header-anchor" href="#_5-sfinae-ä¸-enable-if-çš„æ·±å…¥åº”ç”¨" aria-label="Permalink to &quot;5. **SFINAE ä¸ enable_if çš„æ·±å…¥åº”ç”¨**&quot;">â€‹</a></h3><p>è™½ç„¶æˆ‘ä»¬çš„ä¾‹å­æ²¡æœ‰ç›´æ¥å±•ç¤ºï¼Œä½† C++/WinRT å¤§é‡ä½¿ç”¨ SFINAEï¼ˆSubstitution Failure Is Not An Errorï¼‰æŠ€æœ¯ï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// SFINAE ç¤ºä¾‹ï¼šåªæœ‰å½“ T æœ‰ put_Value æ–¹æ³•æ—¶æ‰å¯ç”¨æ­¤æ¨¡æ¿</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> set_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> obj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    -&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> decltype</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obj.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">put_Value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value), </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    obj.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">put_Value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æˆ–è€…ä½¿ç”¨ std::enable_if</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">enable_if_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">is_same_v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IAppWindowTitleBar2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">process_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> interface) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // åªæœ‰å½“ T ç¡®å®æ˜¯ IAppWindowTitleBar2 æ—¶æ‰ç¼–è¯‘æ­¤å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>SFINAE çš„ä½œç”¨ï¼š</strong></p><ul><li><strong>ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥</strong>ï¼šç¡®ä¿åªæœ‰ç¬¦åˆæ¡ä»¶çš„ç±»å‹æ‰ä¼šå®ä¾‹åŒ–æ¨¡æ¿</li><li><strong>é¿å…ç¼–è¯‘é”™è¯¯</strong>ï¼šå½“ç±»å‹ä¸åŒ¹é…æ—¶ï¼Œç¼–è¯‘å™¨ä¼šå¿½ç•¥æ­¤æ¨¡æ¿è€Œä¸æ˜¯æŠ¥é”™</li><li><strong>å®ç°é‡è½½è§£æ</strong>ï¼šè®©ç¼–è¯‘å™¨åœ¨å¤šä¸ªæ¨¡æ¿ä¹‹é—´é€‰æ‹©æœ€åˆé€‚çš„ç‰ˆæœ¬</li></ul><h3 id="_6-ç±»å‹èƒå–-type-traits-çš„é«˜çº§åº”ç”¨" tabindex="-1">6. <strong>ç±»å‹èƒå– (Type Traits) çš„é«˜çº§åº”ç”¨</strong> <a class="header-anchor" href="#_6-ç±»å‹èƒå–-type-traits-çš„é«˜çº§åº”ç”¨" aria-label="Permalink to &quot;6. **ç±»å‹èƒå– (Type Traits) çš„é«˜çº§åº”ç”¨**&quot;">â€‹</a></h3><p>C++/WinRT ä½¿ç”¨å¤æ‚çš„ç±»å‹èƒå–æŠ€æœ¯æ¥å¤„ç†ä¸åŒçš„ WinRT ç±»å‹ï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åˆ¤æ–­æ˜¯å¦ä¸º WinRT æ¥å£ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> is_winrt_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : std::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">false_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> is_winrt_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Microsoft</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Windowing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IAppWindowTitleBar2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">true_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è·å– ABI ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> abi_type_traits</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    using</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">abi_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åœ¨ç¼–è¯‘æ—¶é€‰æ‹©ä¸åŒçš„å®ç°è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> process_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> constexpr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">is_winrt_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;::value) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // å¤„ç† WinRT æ¥å£</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // å¤„ç†å…¶ä»–ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>ç±»å‹èƒå–çš„ä¼˜åŠ¿ï¼š</strong></p><ul><li><strong>ç¼–è¯‘æ—¶ç±»å‹ä¿¡æ¯è·å–</strong>ï¼šåœ¨ç¼–è¯‘æœŸå°±èƒ½çŸ¥é“ç±»å‹çš„ç‰¹æ€§</li><li><strong>æ¨¡æ¿ç‰¹åŒ–</strong>ï¼šä¸ºä¸åŒç±»å‹æä¾›ä¸åŒçš„å®ç°</li><li><strong>æ¥å£ç»Ÿä¸€</strong>ï¼šé€šè¿‡ç»Ÿä¸€çš„èƒå–æ¥å£å¤„ç†ä¸åŒç±»å‹</li></ul><h3 id="_7-å®Œç¾è½¬å‘-perfect-forwarding-åœ¨å‚æ•°ä¼ é€’ä¸­çš„åº”ç”¨" tabindex="-1">7. <strong>å®Œç¾è½¬å‘ (Perfect Forwarding) åœ¨å‚æ•°ä¼ é€’ä¸­çš„åº”ç”¨</strong> <a class="header-anchor" href="#_7-å®Œç¾è½¬å‘-perfect-forwarding-åœ¨å‚æ•°ä¼ é€’ä¸­çš„åº”ç”¨" aria-label="Permalink to &quot;7. **å®Œç¾è½¬å‘ (Perfect Forwarding) åœ¨å‚æ•°ä¼ é€’ä¸­çš„åº”ç”¨**&quot;">â€‹</a></h3><p>è™½ç„¶æˆ‘ä»¬çš„ä¾‹å­ä½¿ç”¨çš„æ˜¯ <code>const&amp;</code>ï¼Œä½† C++/WinRT åœ¨å¾ˆå¤šåœ°æ–¹ä½¿ç”¨äº†å®Œç¾è½¬å‘ï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> impl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forward</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(value));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿™æ ·å¯ä»¥åŒæ—¶å¤„ç†å·¦å€¼å’Œå³å€¼ï¼Œä¸”ä¿æŒå…¶å±æ€§</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(some_value);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // å·¦å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">move</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value));</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å³å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create_value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ä¸´æ—¶å¯¹è±¡</span></span></code></pre></div><p><strong>å®Œç¾è½¬å‘çš„ä»·å€¼ï¼š</strong></p><ul><li><strong>é¿å…ä¸å¿…è¦çš„æ‹·è´</strong>ï¼šå³å€¼ç›´æ¥ç§»åŠ¨ï¼Œå·¦å€¼æ­£å¸¸æ‹·è´</li><li><strong>æ¨¡æ¿é€šç”¨æ€§</strong>ï¼šä¸€ä¸ªæ¨¡æ¿å‡½æ•°å¤„ç†æ‰€æœ‰æƒ…å†µ</li><li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šç‰¹åˆ«æ˜¯å¤„ç†å¤§å¯¹è±¡æ—¶ï¼Œæ€§èƒ½æå‡æ˜æ˜¾</li></ul><h3 id="_8-constexpr-ä¸ç¼–è¯‘æ—¶è®¡ç®—çš„æ·±åº¦åº”ç”¨" tabindex="-1">8. <strong>constexpr ä¸ç¼–è¯‘æ—¶è®¡ç®—çš„æ·±åº¦åº”ç”¨</strong> <a class="header-anchor" href="#_8-constexpr-ä¸ç¼–è¯‘æ—¶è®¡ç®—çš„æ·±åº¦åº”ç”¨" aria-label="Permalink to &quot;8. **constexpr ä¸ç¼–è¯‘æ—¶è®¡ç®—çš„æ·±åº¦åº”ç”¨**&quot;">â€‹</a></h3><p>ç°ä»£ C++ å…è®¸åœ¨ç¼–è¯‘æ—¶è¿›è¡Œå¤æ‚è®¡ç®—ï¼ŒC++/WinRT å……åˆ†åˆ©ç”¨äº†è¿™ä¸€ç‚¹ï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç¼–è¯‘æ—¶è®¡ç®—æ¥å£ ID</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">constexpr</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::guid interface_id_v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">guid_of</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IAppWindowTitleBar2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">constexpr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> bool</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> is_valid_winrt_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> requires</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">abi_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        { T{} } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::convertible_to</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Windows</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Foundation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::IInspectable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä½¿ç”¨ç¼–è¯‘æ—¶æ¡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> process_if_valid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> constexpr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">is_valid_winrt_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;()) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // åªæœ‰æœ‰æ•ˆçš„ WinRT ç±»å‹æ‰ä¼šç¼–è¯‘è¿™éƒ¨åˆ†ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        process_winrt_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="å®é™…å¼€å‘ä¸­çš„æ¨¡æ¿å…ƒç¼–ç¨‹æœ€ä½³å®è·µ" tabindex="-1">å®é™…å¼€å‘ä¸­çš„æ¨¡æ¿å…ƒç¼–ç¨‹æœ€ä½³å®è·µ <a class="header-anchor" href="#å®é™…å¼€å‘ä¸­çš„æ¨¡æ¿å…ƒç¼–ç¨‹æœ€ä½³å®è·µ" aria-label="Permalink to &quot;å®é™…å¼€å‘ä¸­çš„æ¨¡æ¿å…ƒç¼–ç¨‹æœ€ä½³å®è·µ&quot;">â€‹</a></h2><h3 id="_9-é”™è¯¯è¯Šæ–­ä¸è°ƒè¯•æŠ€å·§" tabindex="-1">9. <strong>é”™è¯¯è¯Šæ–­ä¸è°ƒè¯•æŠ€å·§</strong> <a class="header-anchor" href="#_9-é”™è¯¯è¯Šæ–­ä¸è°ƒè¯•æŠ€å·§" aria-label="Permalink to &quot;9. **é”™è¯¯è¯Šæ–­ä¸è°ƒè¯•æŠ€å·§**&quot;">â€‹</a></h3><p>æ¨¡æ¿å…ƒç¼–ç¨‹çš„é”™è¯¯ä¿¡æ¯é€šå¸¸å¾ˆéš¾ç†è§£ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å®ç”¨æŠ€å·§ï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä½¿ç”¨ static_assert æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require_winrt_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> obj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    static_assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">is_winrt_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">decay_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;::value, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  &quot;T must be a WinRT interface type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    static_assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::is_pointer_v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">decay_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  &quot;Pass WinRT objects by value or reference, not pointer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä½¿ç”¨ concept (C++20) æä¾›æ›´å¥½çš„é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">concept</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WinRTInterface </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> requires</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">abi_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    requires</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::is_convertible_v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Windows</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Foundation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::IInspectable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WinRTInterface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> process_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å¦‚æœ T ä¸æ»¡è¶³ WinRTInterfaceï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºæ¸…æ™°çš„é”™è¯¯ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_10-æ€§èƒ½åˆ†æä¸ä¼˜åŒ–" tabindex="-1">10. <strong>æ€§èƒ½åˆ†æä¸ä¼˜åŒ–</strong> <a class="header-anchor" href="#_10-æ€§èƒ½åˆ†æä¸ä¼˜åŒ–" aria-label="Permalink to &quot;10. **æ€§èƒ½åˆ†æä¸ä¼˜åŒ–**&quot;">â€‹</a></h3><p>æ¨¡æ¿å…ƒç¼–ç¨‹çš„æ€§èƒ½ç‰¹ç‚¹ï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç¼–è¯‘æ—¶å¼€é”€ vs è¿è¡Œæ—¶å¼€é”€å¯¹æ¯”</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿è¡Œæ—¶å¤šæ€ - æœ‰è™šå‡½æ•°å¼€é”€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RuntimeInterface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    virtual</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // è™šå‡½æ•°è°ƒç”¨å¼€é”€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    virtual</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ~RuntimeInterface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç¼–è¯‘æ—¶å¤šæ€ - é›¶è¿è¡Œæ—¶å¼€é”€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> compile_time_call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> obj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    obj.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ç›´æ¥å‡½æ•°è°ƒç”¨ï¼Œå¯èƒ½è¢«å†…è”</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼š</strong></p><ol><li><strong>ç¼–è¯‘æ—¶è®¡ç®—</strong>ï¼šèƒ½åœ¨ç¼–è¯‘æ—¶ç¡®å®šçš„å°½é‡ä¸ç•™åˆ°è¿è¡Œæ—¶</li><li><strong>å†…è”ä¼˜åŒ–</strong>ï¼šæ¨¡æ¿å‡½æ•°æ›´å®¹æ˜“è¢«ç¼–è¯‘å™¨å†…è”</li><li><strong>é¿å…ä¸å¿…è¦çš„ç±»å‹è½¬æ¢</strong>ï¼šä½¿ç”¨ç²¾ç¡®çš„ç±»å‹åŒ¹é…</li><li><strong>åˆç†ä½¿ç”¨ constexpr</strong>ï¼šæ ‡è®°ç¼–è¯‘æ—¶å¸¸é‡è¡¨è¾¾å¼</li></ol><h3 id="_11-ä¸ç°ä»£-c-ç‰¹æ€§çš„ç»“åˆ" tabindex="-1">11. <strong>ä¸ç°ä»£ C++ ç‰¹æ€§çš„ç»“åˆ</strong> <a class="header-anchor" href="#_11-ä¸ç°ä»£-c-ç‰¹æ€§çš„ç»“åˆ" aria-label="Permalink to &quot;11. **ä¸ç°ä»£ C++ ç‰¹æ€§çš„ç»“åˆ**&quot;">â€‹</a></h3><p>C++/WinRT ç§¯æé‡‡ç”¨ç°ä»£ C++ ç‰¹æ€§ï¼š</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// C++20 Concepts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">concept</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WinRTEnum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::is_enum_v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                   requires</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">impl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">enum_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;; };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// C++17 ç»“æ„åŒ–ç»‘å®š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [success, result] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> try_get_interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ITargetInterface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(obj);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// C++20 åç¨‹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">winrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Windows</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Foundation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IAsyncOperation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">async_operation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> co_await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> some_async_call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    co_return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// C++17 if constexpr çš„åµŒå¥—ä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typename</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">auto</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> smart_convert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> constexpr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::is_integral_v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">decay_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> constexpr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::is_signed_v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">decay_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> convert_signed_integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> convert_unsigned_integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> constexpr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::is_floating_point_v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">decay_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> convert_floating_point</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> convert_other_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">std</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forward</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(value));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="æ€»ç»“ä¸å±•æœ›" tabindex="-1">æ€»ç»“ä¸å±•æœ› <a class="header-anchor" href="#æ€»ç»“ä¸å±•æœ›" aria-label="Permalink to &quot;æ€»ç»“ä¸å±•æœ›&quot;">â€‹</a></h2><h3 id="æ ¸å¿ƒè®¾è®¡ç†å¿µ" tabindex="-1">æ ¸å¿ƒè®¾è®¡ç†å¿µ <a class="header-anchor" href="#æ ¸å¿ƒè®¾è®¡ç†å¿µ" aria-label="Permalink to &quot;æ ¸å¿ƒè®¾è®¡ç†å¿µ&quot;">â€‹</a></h3><p>C++/WinRT çš„æ¨¡æ¿å…ƒç¼–ç¨‹è®¾è®¡ä½“ç°äº†ä»¥ä¸‹æ ¸å¿ƒç†å¿µï¼š</p><ol><li><strong>é›¶å¼€é”€æŠ½è±¡</strong>ï¼šé«˜çº§æ¥å£ä¸åº”å¸¦æ¥è¿è¡Œæ—¶æ€§èƒ½æŸå¤±</li><li><strong>ç±»å‹å®‰å…¨</strong>ï¼šç¼–è¯‘æ—¶æ•è·ç±»å‹é”™è¯¯ï¼Œé¿å…è¿è¡Œæ—¶é—®é¢˜</li><li><strong>å¼€å‘æ•ˆç‡</strong>ï¼šæä¾›ç®€æ´æ˜“ç”¨çš„ APIï¼Œéšè—å¤æ‚çš„åº•å±‚ç»†èŠ‚</li><li><strong>å‘åå…¼å®¹</strong>ï¼šä¸ç°æœ‰ COM åŸºç¡€è®¾æ–½å®Œå…¨å…¼å®¹</li></ol><h3 id="å­¦ä¹ è·¯å¾„å»ºè®®" tabindex="-1">å­¦ä¹ è·¯å¾„å»ºè®® <a class="header-anchor" href="#å­¦ä¹ è·¯å¾„å»ºè®®" aria-label="Permalink to &quot;å­¦ä¹ è·¯å¾„å»ºè®®&quot;">â€‹</a></h3><p>è¦æŒæ¡è¿™æ ·çš„é«˜çº§æ¨¡æ¿å…ƒç¼–ç¨‹æŠ€æœ¯ï¼Œå»ºè®®æŒ‰ä»¥ä¸‹è·¯å¾„å­¦ä¹ ï¼š</p><p><strong>åŸºç¡€é˜¶æ®µï¼š</strong></p><ol><li>C++ åŸºç¡€è¯­æ³•ï¼ˆæŒ‡é’ˆã€å¼•ç”¨ã€ç±»ï¼‰</li><li>åŸºç¡€æ¨¡æ¿ï¼ˆå‡½æ•°æ¨¡æ¿ã€ç±»æ¨¡æ¿ï¼‰</li><li>æ ‡å‡†åº“å®¹å™¨å’Œç®—æ³•</li></ol><p><strong>è¿›é˜¶é˜¶æ®µï¼š</strong> 4. ç°ä»£ C++ ç‰¹æ€§ï¼ˆautoã€lambdaã€æ™ºèƒ½æŒ‡é’ˆï¼‰ 5. é«˜çº§æ¨¡æ¿æŠ€æœ¯ï¼ˆç‰¹åŒ–ã€èƒå–ã€SFINAEï¼‰ 6. å…ƒç¼–ç¨‹æ¦‚å¿µï¼ˆç¼–è¯‘æ—¶è®¡ç®—ã€ç±»å‹æ“ä½œï¼‰</p><p><strong>ä¸“ä¸šé˜¶æ®µï¼š</strong> 7. COM åŸºç¡€çŸ¥è¯† 8. WinRT æ¶æ„ç†è§£ 9. C++/WinRT æ¡†æ¶æ·±å…¥ç ”ç©¶ 10. å®é™…é¡¹ç›®å®è·µ</p><p>é€šè¿‡æ·±å…¥ç†è§£è¿™äº›æ¦‚å¿µï¼Œä½ ä¸ä»…èƒ½æ›´å¥½åœ°ä½¿ç”¨ C++/WinRTï¼Œè¿˜èƒ½åœ¨å…¶ä»–éœ€è¦é«˜æ€§èƒ½å’Œç±»å‹å®‰å…¨çš„åœºæ™¯ä¸­åº”ç”¨ç±»ä¼¼çš„è®¾è®¡æ¨¡å¼ã€‚è¿™æ­£æ˜¯ç°ä»£ C++ æ¨¡æ¿å…ƒç¼–ç¨‹çš„é­…åŠ›æ‰€åœ¨ï¼šç”¨ç¼–è¯‘æ—¶çš„å¤æ‚æ€§æ¢å–è¿è¡Œæ—¶çš„ç®€æ´ä¸é«˜æ•ˆã€‚</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/vitepresspages/WinUI3/TitleBar.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>cpp/WinRTå…¥é—¨-TitleBaræ ‡é¢˜æ </span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/vitepresspages/WinUI3/Loaded.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>cpp/WinRTå…¥é—¨-Loadedäº‹ä»¶</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"c___2.md\":\"DjMgGOCl\",\"c___memory1.md\":\"DxWxdtIL\",\"c___å­—ç¬¦ä¸².md\":\"Cgmq0Agb\",\"c___æŒ‡é’ˆ.md\":\"DmKyeohb\",\"c___ç›®å½•.md\":\"DJ0IQXfm\",\"c___è¿ç»­è¯»å–.md\":\"CkeBabpD\",\"friends.md\":\"DBcuyvVO\",\"gitbookæœ¬åœ°éƒ¨ç½²å…¨æŒ‡å—_gitbookéƒ¨ç½²ç®€ä»‹.md\":\"DEwZ2v0L\",\"gitbookæœ¬åœ°éƒ¨ç½²å…¨æŒ‡å—_step1-ç¯å¢ƒå‡†å¤‡.md\":\"6xDU7H1e\",\"gitbookæœ¬åœ°éƒ¨ç½²å…¨æŒ‡å—_step2-gitbook.md\":\"pg9czuZV\",\"gitbookæœ¬åœ°éƒ¨ç½²å…¨æŒ‡å—_step3-gitbookè¿›é˜¶.md\":\"Dce-J8e7\",\"index.md\":\"-b14q6Pw\",\"markdown-examples.md\":\"DAKMSRv2\",\"readme.md\":\"DnDNDkFc\",\"windows_index.md\":\"DLB0q3M0\",\"windows_windowså†…æ ¸.md\":\"PaCzluSe\",\"winui3_data_ui.md\":\"Bq7wmzd9\",\"winui3_ep3.md\":\"CRISNe9u\",\"winui3_index.md\":\"C9Fnzuuu\",\"winui3_initializecomponent.md\":\"CIsku4Kf\",\"winui3_interface.md\":\"BW6S1wYD\",\"winui3_loaded.md\":\"pGbfFufO\",\"winui3_page_window1.md\":\"DtU_0dgG\",\"winui3_page_window2.md\":\"qkiMQ6Pr\",\"winui3_scale.md\":\"BPk3fUNq\",\"winui3_swapchainpanel.md\":\"ByC4VwMp\",\"winui3_template.md\":\"r3NsfvdX\",\"winui3_titlebar.md\":\"COAkMMRI\",\"winui3_winui3-advanced-binding.md\":\"D5qGbcsF\",\"winui3_winui3-winrt-cpp-å®Œæ•´æ•™ç¨‹-ç¬¬ä¸€éƒ¨åˆ†-åŸºç¡€æ¦‚å¿µä¸æ¶æ„.md\":\"CXKMMyCO\",\"winui3_winui3-winrt-cpp-å®Œæ•´æ•™ç¨‹-ç¬¬ä¸‰éƒ¨åˆ†-é«˜çº§ç‰¹æ€§ä¸æ·±åº¦å¼€å‘.md\":\"0qKaCzqE\",\"winui3_winui3-winrt-cpp-å®Œæ•´æ•™ç¨‹-ç¬¬äºŒéƒ¨åˆ†-å®è·µå¼€å‘æŒ‡å—.md\":\"CSy9q0wO\",\"winui3_winui3-winrt-cpp-å®Œæ•´æ•™ç¨‹-ç¬¬äº”éƒ¨åˆ†-xamlæ¡†æ¶ä¸æ•°æ®ç»‘å®šæ·±å±‚æœºåˆ¶.md\":\"D4h55b-H\",\"winui3_winui3-winrt-cpp-å®Œæ•´æ•™ç¨‹-ç¬¬å…­éƒ¨åˆ†-å®æˆ˜æŠ€å·§ä¸æœ€ä½³å®è·µ.md\":\"yZExZe3k\",\"winui3_winui3-winrt-cpp-å®Œæ•´æ•™ç¨‹-ç¬¬å››éƒ¨åˆ†-åŸºç¡€apiä¸ç±»å‹ç³»ç»Ÿæ·±åº¦è§£æ.md\":\"Iq7tgIs9\",\"winui3_winui3-winrt-cpp-å®Œæ•´æ•™ç¨‹-ç¬¬é›¶éƒ¨åˆ†-ç¯å¢ƒé…ç½®ä¸åŸºç¡€æ¦‚å¿µ.md\":\"CLHeKWty\",\"è®¡ç®—æœºå›¾å½¢å­¦_ç›®å½•.md\":\"9xfedz6b\",\"è®¡ç®—æœºç½‘ç»œ_5g.md\":\"Ce3ctpUg\",\"è®¡ç®—æœºç½‘ç»œ_bt.md\":\"CarG1Qna\",\"è®¡ç®—æœºç½‘ç»œ_index.md\":\"tokUhwfa\",\"è®¡ç®—æœºç½‘ç»œ_tcpipåè®®å¼€é”€.md\":\"BCQkttL5\",\"è®¡ç®—æœºç½‘ç»œ_ç³»ç»Ÿä»£ç†.md\":\"BrfS_L_S\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Hoshiizumiya\",\"description\":\"learn notes\",\"base\":\"/vitepresspages/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/index.md\"},{\"text\":\"About me\",\"link\":\"/README.md\"}],\"sidebar\":[{\"text\":\"è¿‡æ—¶çš„é¡¹ç›®æŒ‡å—\",\"items\":[{\"text\":\"gitbookæœ¬åœ°éƒ¨ç½²\",\"link\":\"/gitbookæœ¬åœ°éƒ¨ç½²å…¨æŒ‡å—/gitbookéƒ¨ç½²ç®€ä»‹\"}]},{\"text\":\"C++\",\"items\":[{\"text\":\"ç›®å½•\",\"link\":\"/C++/ç›®å½•\"},{\"text\":\"å­—ç¬¦ä¸²\",\"link\":\"/C++/å­—ç¬¦ä¸²\"},{\"text\":\"æŒ‡é’ˆ\",\"link\":\"/C++/æŒ‡é’ˆ\"},{\"text\":\"è¿ç»­è¯»å–\",\"link\":\"/C++/è¿ç»­è¯»å–\"},{\"text\":\"JAVAç±»æ•°ç»„å’Œæ–¹æ³•çš„é‡æ„\",\"link\":\"/C++/2\"},{\"text\":\"C++ 11 â€”â€” ç§»åŠ¨è¯­ä¹‰\",\"link\":\"/C++/memory1\"}]},{\"text\":\"è®¡ç®—æœºå›¾å½¢å­¦\",\"items\":[{\"text\":\"ç›®å½•\",\"link\":\"/è®¡ç®—æœºå›¾å½¢å­¦/ç›®å½•.md\"}]},{\"text\":\"WinUI3 C++/WinRT åŸç†åŠå®è·µ\",\"items\":[{\"text\":\"ç›®å½•\",\"link\":\"/WinUI3/index.md\"},{\"text\":\"EP3\",\"link\":\"/WinUI3/EP3.md\"},{\"text\":\"cpp/WinRTå…¥é—¨-TitleBaræ ‡é¢˜æ \",\"link\":\"/WinUI3/TitleBar.md\"},{\"text\":\"cpp/WinRTå…¥é—¨-æ¨¡æ¿å…ƒç¼–ç¨‹åœ¨ WinRT ä¸­çš„å®ç°\",\"link\":\"/WinUI3/Template.md\"},{\"text\":\"cpp/WinRTå…¥é—¨-Loadedäº‹ä»¶\",\"link\":\"/WinUI3/Loaded.md\"},{\"text\":\"cpp/WinRTå…¥é—¨-é¡µé¢æ“ä½œå…¶ä¸€\",\"link\":\"/WinUI3/Page&Window1.md\"},{\"text\":\"cpp/WinRTå…¥é—¨-é¡µé¢æ“ä½œå…¶äºŒ\",\"link\":\"/WinUI3/Page&Window2.md\"},{\"text\":\"cpp/WinRTå…¥é—¨-é¡µé¢åˆå§‹åŒ–\",\"link\":\"/WinUI3/InitializeComponent.md\"},{\"text\":\"cpp/WinRTå…¥é—¨-æ•°æ®ä¸ç•Œé¢ç»‘å®šæ›´æ–°\",\"link\":\"/WinUI3/data&ui.md\"},{\"text\":\"cpp/WinRTå…¥é—¨-é«˜çº§æ•°æ®ç»‘å®šä¸ MVVM æ¶æ„å®è·µP1\",\"link\":\"/WinUI3/winui3-advanced-binding.md\"},{\"text\":\"cpp/WinRTå…¥é—¨-WinRT æ¥å£æœºåˆ¶ä¸ç»§æ‰¿æ¨¡å‹è¯¦è§£\",\"link\":\"/WinUI3/interface.md\"},{\"text\":\"ç³»åˆ—æ•™ç¨‹-ç¬¬é›¶éƒ¨åˆ†-ç¯å¢ƒé…ç½®ä¸åŸºç¡€æ¦‚å¿µ\",\"link\":\"/WinUI3/WinUI3-WinRT-CPP-å®Œæ•´æ•™ç¨‹-ç¬¬é›¶éƒ¨åˆ†-ç¯å¢ƒé…ç½®ä¸åŸºç¡€æ¦‚å¿µ.md\"},{\"text\":\"ç³»åˆ—æ•™ç¨‹-ç¬¬ä¸€éƒ¨åˆ†-åŸºç¡€æ¦‚å¿µä¸æ¶æ„\",\"link\":\"/WinUI3/WinUI3-WinRT-CPP-å®Œæ•´æ•™ç¨‹-ç¬¬ä¸€éƒ¨åˆ†-åŸºç¡€æ¦‚å¿µä¸æ¶æ„.md\"},{\"text\":\"ç³»åˆ—æ•™ç¨‹-ç¬¬äºŒéƒ¨åˆ†-å®è·µå¼€å‘æŒ‡å—\",\"link\":\"/WinUI3/WinUI3-WinRT-CPP-å®Œæ•´æ•™ç¨‹-ç¬¬äºŒéƒ¨åˆ†-å®è·µå¼€å‘æŒ‡å—.md\"},{\"text\":\"ç³»åˆ—æ•™ç¨‹-ç¬¬ä¸‰éƒ¨åˆ†-é«˜çº§ç‰¹æ€§ä¸æ·±åº¦å¼€å‘\",\"link\":\"/WinUI3/WinUI3-WinRT-CPP-å®Œæ•´æ•™ç¨‹-ç¬¬ä¸‰éƒ¨åˆ†-é«˜çº§ç‰¹æ€§ä¸æ·±åº¦å¼€å‘.md\"},{\"text\":\"ç³»åˆ—æ•™ç¨‹-ç¬¬å››éƒ¨åˆ†-åŸºç¡€APIä¸ç±»å‹ç³»ç»Ÿæ·±åº¦è§£æ\",\"link\":\"/WinUI3/WinUI3-WinRT-CPP-å®Œæ•´æ•™ç¨‹-ç¬¬å››éƒ¨åˆ†-åŸºç¡€APIä¸ç±»å‹ç³»ç»Ÿæ·±åº¦è§£æ.md\"},{\"text\":\"ç³»åˆ—æ•™ç¨‹-ç¬¬äº”éƒ¨åˆ†-XAMLæ¡†æ¶ä¸æ•°æ®ç»‘å®šæ·±å±‚æœºåˆ¶\",\"link\":\"/WinUI3/WinUI3-WinRT-CPP-å®Œæ•´æ•™ç¨‹-ç¬¬äº”éƒ¨åˆ†-XAMLæ¡†æ¶ä¸æ•°æ®ç»‘å®šæ·±å±‚æœºåˆ¶.md\"},{\"text\":\"ç³»åˆ—æ•™ç¨‹-ç¬¬å…­éƒ¨åˆ†-å®æˆ˜æŠ€å·§ä¸æœ€ä½³å®è·µ\",\"link\":\"/WinUI3/WinUI3-WinRT-CPP-å®Œæ•´æ•™ç¨‹-ç¬¬å…­éƒ¨åˆ†-å®æˆ˜æŠ€å·§ä¸æœ€ä½³å®è·µ.md\"},{\"text\":\"Windows ç¼©æ”¾æ§åˆ¶\",\"link\":\"/WinUI3/scale.md\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/hoshiizumiya\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>